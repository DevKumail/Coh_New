<!-- <div class="card"> -->
<div class="row d-flex">
    <div class="col-6">
        <div class="card">
            <div class="accordion" id="Notificationaccordion">
                <div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                          <button #notificationToggler class="accordion-button collapsed d-flex align-items-center justify-content-between no-accordion-caret w-100 gap-2" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNotification" aria-expanded="false" aria-controls="collapseNotification">
                            <span>{{ 'Notification' | translate }}</span>
                            <ng-icon style="color: orange;" [name]="isNotificationFiltered ? 'tablerFilterFill' : 'tablerFilter'" [ngClass]="{ 'blink': isNotificationFiltered }"></ng-icon>
                          </button>
                        </h2>
                        <div id="collapseNotification" class="accordion-collapse collapse" data-bs-parent="#Notificationaccordion">
                          <div class="accordion-body">
                        <form *ngIf="NotificationFilterForm" [formGroup]="NotificationFilterForm">
                        <div class="row">
                            <div class="col-md-6">
                                <label>{{ 'From Date' | translate }}</label>
                                <input type="date" class="form-control"formControlName="fromDate" />
                            </div>
                      
                            <div class="col-md-6">
                                <label>{{ 'To Date' | translate }}</label>
                                <input type="date" class="form-control"formControlName="toDate" />
                            </div>
                            <div class="col-12 mt-3 d-flex justify-content-end gap-2">
                                <button type="button" class="btn btn-outline-secondary btn-sm" (click)="onClearNotification()">{{ 'Clear' | translate }}</button>
                                <button type="button" class="btn btn-primary btn-sm" (click)="onSearchNotification()">{{ 'Search' | translate }}</button>
                            </div>
                        </div>
                        </form>
                          </div>
                        </div>
                      </div>
                </div>
                </div> 
        <div class="table-responsive">
            <table class="table table-custom align-middle mb-0 table-striped">
                <thead class="bg-light align-middle bg-opacity-25 thead-sm">
                    <tr class="text-uppercase fs-xxs">
                        <th>{{ 'Date' | translate }}</th>
                        <th>{{ 'Subject' | translate }}</th>
                        <th>{{ 'Patient Name (MR No)' | translate }}</th>
                        <th>{{ 'Sender' | translate }}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let appointment of other">
                        <td>
                            {{ appointment.appDateTime | date : "dd/MM/yyyy h:mm a" }}
                        </td>
                        <td>{{ appointment.subject }}</td>
                        <td>{{ appointment.patient_FName }} ({{ appointment.mrNo }})</td>
                        <td>{{ appointment.sender }}</td>
                    </tr>
                    <tr *ngIf="appointments.length === 0">
                        <td colspan="9">{{ 'No appointment found.' | translate }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!-- <hr class="table-group-divider"> -->
    <div class="card mt-2" *ngIf="canShowNotes">
        <div class="accordion" id="Notesaccordion">
            <div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                      <button #notesToggler class="accordion-button collapsed d-flex align-items-center justify-content-between no-accordion-caret w-100 gap-2" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNotes" aria-expanded="false" aria-controls="collapseNotes">
                        <span>{{ 'Notes' | translate }}</span>
                        <ng-icon style="color: orange;" [name]="isNotesFiltered ? 'tablerFilterFill' : 'tablerFilter'" [ngClass]="{ 'blink': isNotesFiltered }"></ng-icon>
                      </button>
                    </h2>
                    <div id="collapseNotes" class="accordion-collapse collapse" data-bs-parent="#Notesaccordion">
                      <div class="accordion-body">
                    <form *ngIf="NotesFilterForm" [formGroup]="NotesFilterForm">
                    <div class="row">
                        <div class="col-md-6">
                            <label>{{ 'From Date' | translate }}</label>
                            <input type="date" class="form-control" formControlName="fromDate"/>
                        </div>
                  
                        <div class="col-md-6">
                            <label>{{ 'To Date' | translate }}</label>
                            <input type="date" class="form-control" formControlName="toDate"/>
                        </div>
                        <div class="col-12 mt-3 d-flex justify-content-end gap-2">
                            <button type="button" class="btn btn-outline-secondary btn-sm" (click)="onClearNotes()">{{ 'Clear' | translate }}</button>
                            <button type="button" class="btn btn-primary btn-sm" (click)="onSearchNotes()">{{ 'Search' | translate }}</button>
                        </div>
                    </div>
                    </form>
                      </div>
                    </div>
                  </div>
            </div>
            </div> 
        <div class="table-responsive">
            <table class="table table-custom align-middle mb-0 table-striped">
                <thead class="bg-light align-middle bg-opacity-25 thead-sm">
                    <tr class="text-uppercase fs-xxs">
                        <th>{{ 'Date' | translate }}</th>
                        <th>{{ 'Subject' | translate }}</th>
                        <th>{{ 'Patient Name (MR No)' | translate }}</th>
                        <th>{{ 'Sender' | translate }}</th>
                    </tr>
                </thead>
                <tbody >
                    <tr *ngFor="let appointment of other">
                        <td>
                            {{ appointment.appDateTime | date : "dd/MM/yyyy h:mm a" }}
                        </td>
                        <td>{{ appointment.subject }}</td>
                        <td>{{ appointment.patient_FName }} ({{ appointment.mrNo }})</td>
                        <td>{{ appointment.sender }}</td>
                    </tr>
                    <tr *ngIf="appointments.length === 0">
                        <td colspan="9">No appointment found.</td>
                    </tr>
                </tbody>
            </table>
        </div>
        </div>  
        <!-- <hr class="table-group-divider"> -->
        <div class="card mt-2" *ngIf="canShowBilled">
            <div class="accordion" id="Billedaccordion">
                <div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                          <button #billedToggler class="accordion-button collapsed d-flex align-items-center justify-content-between no-accordion-caret w-100 gap-2" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBilled" aria-expanded="false" aria-controls="collapseBilled">
                            <span>{{ 'Billed' | translate }}</span>
                            <ng-icon style="color: orange;" [name]="isBilledFiltered ? 'tablerFilterFill' : 'tablerFilter'" [ngClass]="{ 'blink': isBilledFiltered }"></ng-icon>
    
                          </button>
                        </h2>
                        <div id="collapseBilled" class="accordion-collapse collapse" data-bs-parent="#Billedaccordion">
                          <div class="accordion-body">
                        <form *ngIf="BilledFilterForm" [formGroup]="BilledFilterForm">
                        <div class="row">
                            <div class="col-md-6">
                                <label>{{ 'From Date' | translate }}</label>
                                <input
                                    type="date"
                                    class="form-control"
                                    formControlName="fromDate"
                                />
                            </div>
                      
                            <div class="col-md-6">
                                <label>{{ 'To Date' | translate }}</label>
                                <input
                                    type="date"
                                    class="form-control"
                                    formControlName="toDate"
                                />
                            </div>
                            <div class="col-12 mt-3 d-flex justify-content-end gap-2">
                                <button type="button" class="btn btn-outline-secondary btn-sm" (click)="onClearBilled()">{{ 'Clear' | translate }}</button>
                                <button type="button" class="btn btn-primary btn-sm" (click)="onSearchBilled()">{{ 'Search' | translate }}</button>
                            </div>
                        </div>
                        </form>
                          </div>
                        </div>
                      </div>
                </div>
                </div> 
            <div class="table-responsive">
                <table class="table table-custom align-middle mb-0 table-striped">
                    <thead class="bg-light align-middle bg-opacity-25 thead-sm">
                        <tr class="text-uppercase fs-xxs">
                            <th>{{ 'Date' | translate }}</th>
                            <th>{{ 'Subject' | translate }}</th>
                            <th>{{ 'Patient Name (MR No)' | translate }}</th>
                            <th>{{ 'Sender' | translate }}</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let appointment of other">
                            <td>
                                {{ appointment.appDateTime | date : "dd/MM/yyyy h:mm a" }}
                            </td>
                            <td>{{ appointment.subject }}</td>
                            <td>{{ appointment.patient_FName }} ({{ appointment.mrNo }})</td>
                            <td>{{ appointment.sender }}</td>
                        </tr>
                        <tr *ngIf="appointments.length === 0">
                            <td colspan="9">No appointment found.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            </div>
    </div>
    <div class="col-6">
        <div class="card">
        <div class="accordion" id="Appointmentaccordion">
            <div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                      <button #appointmentToggler class="accordion-button collapsed d-flex align-items-center justify-content-between no-accordion-caret w-100 gap-2" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAppointment" aria-expanded="false" aria-controls="collapseAppointment">
                        <span>{{ 'Appointment' | translate }}</span>
                        <ng-icon style="color: orange;" [name]="isAppointmentFiltered ? 'tablerFilterFill' : 'tablerFilter'" [ngClass]="{ 'blink': isAppointmentFiltered }"></ng-icon>
                      </button>
                    </h2>
                    <div id="collapseAppointment" class="accordion-collapse collapse" data-bs-parent="#Appointmentaccordion">
                      <div class="accordion-body">
                          <form *ngIf="AppointmentFilterForm" [formGroup]="AppointmentFilterForm">
                    <div class="row">
                        <div class="col-md-4">
                            <label>{{ 'Provider' | translate }}</label>
                            <select class="form-control" formControlName="providerId">
                                <option value="">-- {{ 'Provider' | translate }} --</option>
                                <option *ngFor="let item of providers" [value]="item.code">
                                    {{ item.name }}
                                </option>
                            </select>
                        </div>
                  
                        <div class="col-md-4">
                            <label>{{ 'Facility' | translate }}</label>
                            <select class="form-control form-select" formControlName="facility">
                                <option value="">-- {{ 'Facility' | translate }} --</option>
                                <option *ngFor="let f of facilities" [value]="f.code">
                                    {{ f.name }}
                                </option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label>{{ 'Site' | translate }}</label>
                            <select class="form-control" formControlName="sitesId">
                                <option value="">-- {{ 'Site' | translate }} --</option>
                                <option *ngFor="let item of sites" [value]="item.code">
                                    {{ item.name }}
                                </option>
                            </select>
                        </div>

                        
                        <div class="col-md-4">
                            <label>{{ 'Appointment Date' | translate }}</label>
                            <input type="date" class="form-control" formControlName="appDate">
                        </div>


                        <div class="col-md-4">
                            <label>{{ 'Status' | translate }}</label>
                            <select #statusesSel class="form-select" choicesSelect [options]="{ removeItemButton: true, placeholder: true, placeholderValue: 'Select Status' }"
                                 formControlName="statuses" name="choices-multiple-remove-button" multiple>
                                <option *ngFor="let s of statusOptions" [value]="s.id">{{ s.name }}</option>
                            </select>
                        </div>
                        <div class="col-md-4" style="margin-top: 16px;">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="chkScheduledOnly" formControlName="showScheduledAppointmentOnly">
                                <label class="form-check-label" for="chkScheduledOnly">
                                    {{ 'Scheduled Appoinment' | translate }}
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="chkChargePending" formControlName="showChargeCapturePending">
                                <label class="form-check-label" for="chkChargePending">
                                    {{ 'Charge Capture Pending' | translate }}
                                </label>
                            </div>
                        </div>

                        <!-- <div class="col-md-4">
                        </div> -->

                        <div class="col-12 mt-3 d-flex justify-content-end gap-2">
                            <button type="button" class="btn btn-outline-secondary btn-sm" (click)="onClearAppointment()">{{ 'Clear' | translate }}</button>
                            <button type="button" class="btn btn-primary btn-sm" (click)="onSearchAppointment()">{{ 'Search' | translate }}</button>
                        </div>
                    </div>
                    </form>
                      </div>
                    </div>
                  </div>
            </div>
            </div>


            <div class="table-responsive">
                <table class="table table-custom align-middle mb-0 table-striped">
                    <thead class="bg-light align-middle bg-opacity-25 thead-sm">
                        <tr class="text-uppercase fs-xxs">
                            <th>{{ 'App Date' | translate }}</th>
                            <th>{{ 'Name' | translate }}</th>
                            <th>{{ 'Status' | translate }}</th>
                            <th>{{ 'Site' | translate }}</th>
                            <th>{{ 'Action' | translate }}</th>
                        </tr>
                    </thead>
                    <tbody >
                        <tr class="text-nowrap" *ngFor="let appointment of appointments">
                            <td>
                                {{ appointment.appDateTime | date : "dd/MM/yyyy h:mm a"}}
                            </td>
                            <td>{{ appointment.patient_FName }} <br> ({{ appointment.mrNo }})</td>
                            <td>{{ appointment.appointment_PatientStatus }} <br> 
                                <span *ngIf="appointment.patientStatusId == 3">({{ appointment.visitStatusName }})</span></td>
                            <td>{{ appointment.appointment_SiteName }}</td>
                            <td class="d-flex flex-nowrap align-items-center">
                                <div class="dropdown">
                                  <button class="btn p-0 px-1 py-1 me-1" style="font-size: 0.75rem; color: orange;" type="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false" title="Actions">
                                    <ng-icon name="tablerDotsVertical"></ng-icon>
                                  </button>
                                  <ul class="dropdown-menu dropdown-menu-end">
                                    <li style="cursor: pointer;">
                                      <button class="dropdown-item" (click)="onEditAppointment(appointment)">
                                        {{ 'Edit Appointment' | translate }}
                                      </button>
                                    </li>
                                    <!-- *ngIf="appointment.appStatusId == 2" -->
                                    <li class="dropdown-submenu" >
                                      <button class="dropdown-item dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        {{ 'Change Status' | translate }}
                                      </button>
                                      <ul class="dropdown-menu">
                                        <li *ngFor="let s of tableStatus">
                                          <button class="dropdown-item" type="button" (click)="onChangeAppointmentStatus(appointment, s.id)">
                                            {{ s.name }}
                                          </button>
                                        </li>
                                      </ul>
                                    </li>
                                  </ul>
                                </div>
                            </td>
                        </tr>
                        <tr *ngIf="appointments.length === 0">
                            <td colspan="9">No appointment found.</td>
                        </tr>
                    </tbody>
                </table>
                <app-generic-pagination
                    [totalItems]="appointmentstotaldata"
                    [pageSize]="PaginationInfo.RowsPerPage"
                    [currentPage]="PaginationInfo.Page"
                    (pageChanged)="onappointmentsPageChanged($event)"
                >
                </app-generic-pagination>
            </div>
        </div>
    </div>
</div>
<!-- </div> -->

<style>
    .blink {
      /* No blink; emphasize with darker color and bold weight */
      color: #d97706 !important; /* darker orange */
      font-weight: 900;
    }
    /* Nested dropdown positioning */
    .dropdown-submenu { position: relative; }
    .dropdown-submenu > .dropdown-menu {
      position: absolute;
      top: 0;
      left: 100%;
      margin-left: .1rem;
      margin-right: .1rem;
    }
  </style>